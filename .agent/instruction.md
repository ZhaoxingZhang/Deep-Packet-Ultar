# AI 实验设计与执行代理

## 1. 角色与目标

你是一名专业的机器学习研究员和实验设计专家。

你的核心目标是根据以下提供的研究背景和实验思路，设计、实施并评估一系列实验，以验证“面向开放集识别的增量式加密流量分类技术”的有效性。

## 2. 研究背景

*   **核心课题**: 面向开放集识别的增量式加密流量分类技术的研究与实现。
*   **关键挑战**: 
    1.  **开放集识别**: 模型需要有效识别并归类从未见过的新流量类别（即“未知类”）。
    2.  **数据不均衡**: 在真实网络环境中，各类应用的流量数据通常是不均衡的，模型需要在此情况下依然保持稳健的性能。

## 3. 实验设计方案

### **实验一：模型对未知流量类型的适应性 (开放集识别能力) - 最终方案**

*   **基准模型**: **ResNet**
*   **实验假设**: 通过在一个包含“已知类”和“部分未知类”的数据集上进行训练，ResNet模型能够学习到区分“已知”与“未知”的通用边界，并能将训练中从未出现过的、全新的未知类也正确地识别为“未知”。
*   **执行步骤**:
    1.  **三类别划分**: 将总的应用类别（15类）随机划分为三组：
        *   **已知类 (30%, 约4-5类)**: 在训练和测试中都作为独立的、已知的类别存在。
        *   **训练期未知类 (30%, 约4-5类)**: 在训练时，它们的数据被统一映射到一个新增的“未知”标签下，用于教会模型什么是“未知”。
        *   **测试期未知类 (40%, 约6类)**: 这些类别的数据**不在训练中出现**。在测试时，它们也被映射到“未知”标签下，用于检验模型对“未知”概念的泛化能力。
    2.  **模型适配**: ResNet模型的输出层神经元数量需要动态设置为 `(已知类数量 + 1)`。
    3.  **训练与评估**: 在新生成的数据集上训练ResNet模型，并在新的测试集上评估其表现，重点关注其对“测试期未知类”的识别准确率。

### **实验二：模型在数据不均衡场景下的表现 - 暂停**

*   **状态**: 待实验一完成后继续。

## 4. 核心脚本分析

*   `create_train_test_set.py`: 从 `processed_data` 创建训练集和测试集。
*   `train_resnet.py`: 训练ResNet模型。
*   `evaluation.py`: 对训练好的模型进行评估。

## 5. 具体执行计划

### **实验一 (ResNet Baseline) - 执行中**

*   **当前状态**: 已确定最终实验方案，即将开始修改代码。
*   **下一步计划**:
    1.  **修改 `create_train_test_set.py`**: 实现上述的三类别划分（已知/训练期未知/测试期未知）和标签映射逻辑。
    2.  **修改 `ml/utils.py`**: 使 `train_application_classification_resnet_model` 函数的 `output_dim` 参数变为动态可配置。
    3.  **生成数据集**: 运行修改后的脚本，生成实验一的最终数据集。
    4.  **训练模型**: 运行 `train_resnet.py` 训练新的基准模型。
    5.  **评估模型**: 运行 `evaluation.py` (如有必要则进行微调) 对新模型进行评估。

## 6. 实验进展报告

**报告日期:** 2025年8月30日

*   **当前状态**: 已根据您的指示，确定了实验一的最终方案，并将基准模型替换为ResNet。
*   **下一步**: 开始执行新方案的第一步：修改 `create_train_test_set.py`。
