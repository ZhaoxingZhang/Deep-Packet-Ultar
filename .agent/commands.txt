python train_resnet.py -d train_test_data/exp5_fractional_1_600/application_classification -m model/application_classification.resnet.exp5.baseline.model -t app
python evaluation.py \
              -m model/application_classification.resnet.exp5.baseline.model \
              -d train_test_data/exp4_medium_balanced/application_classification/test.parquet \
              --model_type resnet
python train_resnet.py -d /home/featurize/data/exp6_smote/application_classification -m model/application_classification.resnet.exp6.smote.model -t app
python create_train_test_set.py --source /home/featurize/data/all --target train_test_data/exp5_fractional_1_600 --fraction 0.0017 --batch_size 50
python evaluation.py \
              -m model/application_classification.resnet.exp6.smote.model \
              -d /home/featurize/data/exp6_smote/application_classification/test.parquet \
              --model_type resnet
scp -P 29225 featurize@workspace.featurize.cn:/home/featurize/work/Deep-Packet-Ultar/evaluation_results/application_classification.resnet.exp6.smote ./evaluation_results/
python train_resnet.py -d /home/featurize/data/exp5_fractional_1_600/application_classification -m model/application_classification.resnet.exp5.baseline.model -t app
python evaluation.py \
              -m model/application_classification.resnet.exp5.baseline.model \
              -d /home/featurize/data/exp5_fractional_1_600/application_classification/test.parquet \
              --model_type resnet
python evaluation.py \
              -m model/application_classification.resnet.exp5.attention.model \
              -d /home/featurize/data/exp5_fractional_1_600/application_classification/test.parquet \
              --model_type resnet
 python train_resnet.py \
      -d /home/featurize/data/exp5_fractional_1_600/application_classification \
      -m model/application_classification.resnet.exp7.focal_loss.model \
      -t app \
      --loss_type focal_loss
python evaluation.py \
       -m model/application_classification.resnet.exp7.focal_loss.model \
       -d /home/featurize/data//exp5_fractional_1_600/application_classification/test.parquet \
       --model_type resnet
python train_resnet.py \
      -d /home/featurize/data/exp5_fractional_1_600/application_classification\
      -m model/application_classification.resnet.exp8.class_aware_sampling.model \
      -t app \
      --sampling_strategy class_aware
python evaluation.py \
              -m model/application_classification.resnet.exp8.class_aware_sampling.model \
              -d /home/featurize/data/exp5_fractional_1_600/application_classification/test.parquet \
              --model_type resnet
python create_train_test_set.py \
      -s /home/featurize/data/all \
      -t /home/featurize/data/exp8_majority \
      --experiment_type exp8_majority \
      --fraction 0.0016666667

python preprocessing.py -s /home/featurize/data/VPN-PCAPs -t processed_data/vpn --mask-ports
python preprocessing.py -s /Users/weisman/Documents/repo_root/dataset/ISCX\ VPN-nonVPN\ 2016/PCAPs/VPN-PCAPS -t processed_data/vpn --mask-ports
python create_train_test_set.py -s processed_data/vpn -t train_test_data/vpn  --fraction 0.01 --batch_size 50
nohup python create_train_test_set.py \
  -s /home/featurize/data/processed_data/vpn \
  -t train_test_data/from_featurize_vpn \
  --experiment_type exp2 \
  --fraction 0.01 \
  --batch_size 50 \
  > log/from_featurize_vpn.txt &
watch -n 1 tail -n 50 log/from_featurize_vpn.txt
python train_resnet.py -d /home/featurize/data/train_test_data/from_featurize_vpn/traffic_classification/train.parquet -m model/resnet_vpn_featurize.model -t app

# 创建少数类训练集
python create_train_test_set.py \
--source processed_data/vpn \
--target train_test_data/traffic_minority_expert \
--experiment_type exp8_minority \
--minority-classes 5 \
--minority-classes 7
# 训练少数类专家
python train_resnet.py \
--data_path /home/featurize/data/train_test_data/traffic_minority_expert/traffic_classification \
--model_path model/minority_expert_resnet.pth \
--task traffic
# 验证少数类专家
python evaluation.py \
    --output_dir evaluation_results/minority_expert_resnet \
    --model_path model/minority_expert_resnet.pth.ckpt \
    --data_path /home/featurize/data/train_test_data/traffic_minority_expert/traffic_classification/test.parquet \
    --model_type resnet
# 验证5、7类是否混淆
python analyze_baseline_confidence.py \
--model_path model/resnet_vpn_featurize.model.ckpt \
--data_path /home/featurize/data/train_test_data/from_featurize_vpn/traffic_classification/test.parquet \
--minority-classes 5 \
--minority-classes 7
# 下载衡量结果
scp -P 64802 -r featurize@workspace.featurize.cn:/home/featurize/work/Deep-Packet-Ultar/minority_analysis.csv ./evaluation_results/
# 测试
python evaluation.py \
--data_path /home/featurize/data/train_test_data/from_featurize_vpn/traffic_classification/test.parquet \
--output_dir evaluation_results/ensemble_traffic_minority \
--eval-mode ensemble \
--baseline_model_path model/resnet_vpn_featurize.model.ckpt \
--minority_model_path model/minority_expert_resnet.pth.ckpt \
--minority_classes 5 \
--minority_classes 7 \
--baseline_weight 0.75 \
--minority_weight 0.25

python train_gating_network.py \
--train_data_path /home/featurize/data/train_test_data/from_featurize_vpn/traffic_classification/train.parquet \
--baseline_model_path model/resnet_vpn_featurize.model.ckpt \
--minority_model_path model/minority_expert_resnet.pth.ckpt \
--minority_classes 5 \
--minority_classes 7 \
--output_path model/gating_network.pth \
--epochs 10 \
--lr 0.001

scp -P 56116 featurize@workspace.featurize.cn:/home/featurize/work/Deep-Packet-Ultar/model/* model/

python evaluation.py \
--data_path /home/featurize/data/train_test_data/from_featurize_vpn/traffic_classification/test.parquet \
--output_dir evaluation_results/ensemble_traffic_minority \
--eval-mode gating_ensemble \
--baseline_model_path model/resnet_vpn_featurize.model.ckpt \
--minority_model_path model/minority_expert_resnet.pth.ckpt \
--minority_classes 5 \
--minority_classes 7 \
--gating_network_path model/gating_network.pth

python evaluation.py \
--data_path /home/featurize/data/train_test_data/from_featurize_vpn/traffic_classification/test.parquet \
--output_dir evaluation_results/ensemble_traffic_minority \
--eval-mode ensemble \
--baseline_model_path model/resnet_vpn_featurize.model.ckpt \
--minority_model_path model/minority_expert_resnet.pth.ckpt \
--minority_classes 5 \
--minority_classes 7 \
--baseline_weight 0.999 \
--minority_weight 0.001

python train_gating_network.py \
--train_data_path train_test_data/from_featurize_vpn/traffic_classification/train.parquet \
--baseline_model_path model/resnet_vpn_featurize.model.ckpt \
--minority_model_path model/minority_expert_resnet.pth.ckpt \
--minority_classes 5 \
--minority_classes 7 \
--output_path model/gating_network.pth \
--epochs 10 \
--lr 0.001

python train_gating_network.py \
--train_data_path /home/featurize/data/train_test_data/from_featurize_vpn/traffic_classification/train.parquet \
--baseline_model_path model/resnet_traffic_featurize.model.ckpt \
--minority_model_path model/minority_expert_resnet.pth.ckpt \
--minority_classes 5 --minority_classes 7 \
--output_path model/model/gating_network_lambda_0.3.ckpt \
--epochs 20 \
--lr 0.001 \
--lambda_macro 0.3

ssh featurize@workspace.featurize.cn -p 47690